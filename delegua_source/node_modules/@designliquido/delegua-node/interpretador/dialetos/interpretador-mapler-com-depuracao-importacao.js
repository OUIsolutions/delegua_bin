"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.InterpretadorMaplerComDepuracaoImportacao = void 0;
const estruturas_1 = require("@designliquido/delegua/estruturas");
const mapler_1 = require("@designliquido/delegua/interpretador/dialetos/mapler");
class InterpretadorMaplerComDepuracaoImportacao extends mapler_1.InterpretadorMaplerComDepuracao {
    constructor(importador, diretorioBase, funcaoDeRetorno, funcaoDeRetornoMesmaLinha) {
        super(diretorioBase, funcaoDeRetorno, funcaoDeRetornoMesmaLinha);
        this.importador = importador;
    }
    /**
     * Importa um arquivo como módulo.
     * @param declaracao A declaração de importação.
     * @returns Ou um `DeleguaModulo`, ou um dicionário de funções.
     */
    async visitarDeclaracaoImportar(declaracao) {
        const caminhoRelativo = await this.avaliar(declaracao.caminho);
        const conteudoImportacao = this.importador.importar(caminhoRelativo, false);
        const retornoInterpretador = await this.interpretar(conteudoImportacao.retornoAvaliadorSintatico.declaracoes, true);
        const funcoesChamaveis = this.pilhaEscoposExecucao.obterTodasDeleguaFuncao();
        const novoModulo = new estruturas_1.DeleguaModulo();
        const chavesFuncoesChamaveis = Object.keys(funcoesChamaveis);
        for (let i = 0; i < chavesFuncoesChamaveis.length; i++) {
            novoModulo.componentes[chavesFuncoesChamaveis[i]] = funcoesChamaveis[chavesFuncoesChamaveis[i]];
        }
        return novoModulo;
    }
}
exports.InterpretadorMaplerComDepuracaoImportacao = InterpretadorMaplerComDepuracaoImportacao;
//# sourceMappingURL=interpretador-mapler-com-depuracao-importacao.js.map